<script>
  var countries = [
    { "value": "Afghanistan" },
    { "value": "Albania" },
    { "value": "Algeria" },
    { "value": "American Samoa" },
    { "value": "Andorra" },
    { "value": "Angola" },
    { "value": "Anguilla" },
    { "value": "Antigua and Barbuda" },
    { "value": "Argentina" },
    { "value": "Armenia" },
    { "value": "Aruba" },
    { "value": "Australia" },
    { "value": "Austria" },
    { "value": "Azerbaijan" },
    { "value": "Bahamas" },
    { "value": "Bahrain" },
    { "value": "Bangladesh" },
    { "value": "Barbados" },
    { "value": "Belarus" },
    { "value": "Belgium" },
    { "value": "Belize" },
    { "value": "Benin" },
    { "value": "Bermuda" },
    { "value": "Bhutan" },
    { "value": "Bolivia" },
    { "value": "Bonaire/St Eustatius/Saba" },
    { "value": "Bosnia and Herzegovina" },
    { "value": "Botswana" },
    { "value": "Brazil" },
    { "value": "British Indian Ocean Territory" },
    { "value": "British Virgin Islands" },
    { "value": "Brunei" },
    { "value": "Bulgaria" },
    { "value": "Burkina Faso" },
    { "value": "Burma" },
    { "value": "Burundi" },
    { "value": "Cambodia" },
    { "value": "Cameroon" },
    { "value": "Canada" },
    { "value": "Cape Verde" },
    { "value": "Cayman Islands" },
    { "value": "Central African Republic" },
    { "value": "Chad" },
    { "value": "Chile" },
    { "value": "China" },
    { "value": "Colombia" },
    { "value": "Comoros" },
    { "value": "Congo" },
    { "value": "Costa Rica" },
    { "value": "Cote d’Ivoire" },
    { "value": "Croatia" },
    { "value": "Cuba" },
    { "value": "Curaçao" },
    { "value": "Cyprus" },
    { "value": "Czech Republic" },
    { "value": "Democratic Republic of Congo" },
    { "value": "Denmark" },
    { "value": "Djibouti" },
    { "value": "Dominica" },
    { "value": "Dominican Republic" },
    { "value": "Ecuador" },
    { "value": "Egypt" },
    { "value": "El Salvador" },
    { "value": "Equatorial Guinea" },
    { "value": "Eritrea" },
    { "value": "Estonia" },
    { "value": "Ethiopia" },
    { "value": "Falkland Islands" },
    { "value": "Fiji" },
    { "value": "Finland" },
    { "value": "France" },
    { "value": "French Guiana" },
    { "value": "French Polynesia" },
    { "value": "Gabon" },
    { "value": "Gambia" },
    { "value": "Georgia" },
    { "value": "Germany" },
    { "value": "Ghana" },
    { "value": "Gibraltar" },
    { "value": "Greece" },
    { "value": "Grenada" },
    { "value": "Guadeloupe" },
    { "value": "Guatemala" },
    { "value": "Guernsey" },
    { "value": "Guinea" },
    { "value": "Guinea-Bissau" },
    { "value": "Guyana" },
    { "value": "Haiti" },
    { "value": "Holy See" },
    { "value": "Honduras" },
    { "value": "Hong Kong" },
    { "value": "Hungary" },
    { "value": "Iceland" },
    { "value": "India" },
    { "value": "Indonesia" },
    { "value": "Iran" },
    { "value": "Iraq" },
    { "value": "Ireland" },
    { "value": "Isle of Man" },
    { "value": "Israel" },
    { "value": "Italy" },
    { "value": "Jamaica" },
    { "value": "Japan" },
    { "value": "Jersey" },
    { "value": "Jordan" },
    { "value": "Kazakhstan" },
    { "value": "Kenya" },
    { "value": "Kiribati" },
    { "value": "Kosovo" },
    { "value": "Kuwait" },
    { "value": "Kyrgyzstan" },
    { "value": "Laos" },
    { "value": "Latvia" },
    { "value": "Lebanon" },
    { "value": "Lesotho" },
    { "value": "Liberia" },
    { "value": "Libya" },
    { "value": "Liechtenstein" },
    { "value": "Lithuania" },
    { "value": "Luxembourg" },
    { "value": "Macao" },
    { "value": "Macedonia" },
    { "value": "Madagascar" },
    { "value": "Malawi" },
    { "value": "Malaysia" },
    { "value": "Maldives" },
    { "value": "Mali" },
    { "value": "Malta" },
    { "value": "Marshall Islands" },
    { "value": "Martinique" },
    { "value": "Mauritania" },
    { "value": "Mauritius" },
    { "value": "Mayotte" },
    { "value": "Mexico" },
    { "value": "Micronesia" },
    { "value": "Moldova" },
    { "value": "Monaco" },
    { "value": "Mongolia" },
    { "value": "Montenegro" },
    { "value": "Montserrat" },
    { "value": "Morocco" },
    { "value": "Mozambique" },
    { "value": "Namibia" },
    { "value": "Nauru" },
    { "value": "Nepal" },
    { "value": "Netherlands" },
    { "value": "New Caledonia" },
    { "value": "New Zealand" },
    { "value": "Nicaragua" },
    { "value": "Niger" },
    { "value": "Nigeria" },
    { "value": "North Korea" },
    { "value": "Norway" },
    { "value": "Oman" },
    { "value": "Pakistan" },
    { "value": "Palau" },
    { "value": "Panama" },
    { "value": "Papua New Guinea" },
    { "value": "Paraguay" },
    { "value": "Peru" },
    { "value": "Philippines" },
    { "value": "Pitcairn Island" },
    { "value": "Poland" },
    { "value": "Portugal" },
    { "value": "Qatar" },
    { "value": "Réunion" },
    { "value": "Romania" },
    { "value": "Russia" },
    { "value": "Rwanda" },
    { "value": "Samoa" },
    { "value": "San Marino" },
    { "value": "São Tomé and Principe" },
    { "value": "Saudi Arabia" },
    { "value": "Senegal" },
    { "value": "Serbia" },
    { "value": "Seychelles" },
    { "value": "Sierra Leone" },
    { "value": "Singapore" },
    { "value": "Slovakia" },
    { "value": "Slovenia" },
    { "value": "Solomon Islands" },
    { "value": "Somalia" },
    { "value": "South Africa" },
    { "value": "South Georgia and the South Sandwich Islands" },
    { "value": "South Korea" },
    { "value": "South Sudan" },
    { "value": "Spain" },
    { "value": "Sri Lanka" },
    { "value": "St Helena, Ascension and Tristan da Cunha" },
    { "value": "St Kitts and Nevis" },
    { "value": "St Lucia" },
    { "value": "St Maarten" },
    { "value": "St Pierre & Miquelon" },
    { "value": "St Vincent and The Grenadines" },
    { "value": "Sudan" },
    { "value": "Suriname" },
    { "value": "Swaziland" },
    { "value": "Sweden" },
    { "value": "Switzerland" },
    { "value": "Syria" },
    { "value": "Taiwan" },
    { "value": "Tajikistan" },
    { "value": "Tanzania" },
    { "value": "Thailand" },
    { "value": "The Occupied Palestinian Territories" },
    { "value": "Timor Leste" },
    { "value": "Togo" },
    { "value": "Tonga" },
    { "value": "Trinidad and Tobago" },
    { "value": "Tunisia" },
    { "value": "Turkey" },
    { "value": "Turkmenistan" },
    { "value": "Turks and Caicos Islands" },
    { "value": "Tuvalu" },
    { "value": "Uganda" },
    { "value": "Ukraine" },
    { "value": "United Arab Emirates" },
    { "value": "Uruguay" },
    { "value": "United States of America" },
    { "value": "Uzbekistan" },
    { "value": "Vanuatu" },
    { "value": "Venezuela" },
    { "value": "Vietnam" },
    { "value": "Wallis and Futuna" },
    { "value": "Western Sahara" },
    { "value": "Yemen" },
    { "value": "Zambia" },
    { "value": "Zimbabwe" }
  ];

  $(document).on('click', 'a', function(e) {
    if ( /(remove-link-)([0-9])/.test($(this).attr('id')) ) {
      e.preventDefault();
      $(this).parent().parent().parent().remove();
      remove_links();
      $(this).blur();
    }
  });

  $('#country-list').delegate('span', 'click', function() {
    $('#country-type-ahead input').last().val($(this).html());
    $('#country-list').css('display', 'none');
  });

  $('#country-type-ahead').delegate('input[type="text"]', 'keyup', function() {
    $('#country-list').html('');
    $('#country-list').css({'top': $(this).offset().top + $(this).outerHeight(), 'left': $(this).offset().left, 'display': 'block'});

    if ( /(country-name-)([0-9])/.test($(this).attr('id'))  ) {
      var counter = 0;

      for ( var i = 0; i < countries.length; i++ ) {
        var countryList = countries[i].value.toLowerCase(),
            input = $(this).val().toLowerCase();

        if ( countryList.indexOf(input) > -1 ) {
          $('#country-list').css('border', '1px solid #ccc')
          counter ++;
          if ( counter <= 5 ) {
            $('#country-list').append('<span id="country-link-' + counter + '" class="country-link">' + countries[i].value + '</span>');
          }
        }
      }
    }

    // Clear html when nothing in input
    if ( $(this).val().length === 0 ) {
      $('#country-list').html('');
      $('#country-list').css('display', 'none');
    }

    // Clear border when no match
    if ( $('#country-list').html() === '' ) {
      $('#country-list').css('display', 'none');
    }
  });

  $('#add-another-country').on('click', function(e) {
    e.preventDefault();
    var last_input = $('#country-type-ahead input').last().attr('id'),
        num = last_input.substr(last_input.length - 1);
        num = parseInt(num) + 1;

    $('#country-list').before('<div class="form-group">' +
                      '<label class="form-label" for="country-name-' + num + '">Country name <span></span></label>' +
                      '<input class="form-control" id="country-name-' + num + '" name="country-name-' + num + '"type="text" autocomplete="off">' +
                    '</div>');

    remove_links();

    $(this).blur();
  })

  function remove_links() {
    var last_input = $('#country-type-ahead input').last().attr('id'),
        num = last_input.substr(last_input.length - 1);
        num = parseInt(num) + 1;

    $('.form-label').each(function() {
      if ( num > 2 ) {
        $(this).find('span').html('<a id="remove-link-' + num + '" href="' + Math.random() + '">Remove</a>');
      } else {
        $(this).find('span').html('');
      }
    });
  }
  </script>
